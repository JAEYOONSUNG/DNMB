% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DefenseFinder_plot.R
\name{DefenseFinder_Heatmap}
\alias{DefenseFinder_Heatmap}
\title{Generate a Heatmap for DefenseFinder Results}
\usage{
DefenseFinder_Heatmap(
  analysis_dir = getwd(),
  output_file = "DefenseFinder_Heatmap.pdf",
  color_palette = c("white", "#330066"),
  bar_color = "#4C1C7E",
  gradient_length = 100,
  line_width = 1,
  line_col = "grey80",
  debug = TRUE
)
}
\arguments{
\item{analysis_dir}{Character. The directory containing DefenseFinder result files. Default is the current working directory.}

\item{output_file}{Character. The path to save the generated heatmap as a PDF. Default is \code{"DefenseFinder_Heatmap.pdf"}.}

\item{color_palette}{Character vector. A two-color gradient palette for the heatmap cells. Default is \code{c("white", "#330066")}.}

\item{bar_color}{Character. The color of the barplot showing diversity metrics. Default is \code{"#4C1C7E"}.}

\item{gradient_length}{Integer. Number of steps in the color gradient for the heatmap. Default is \code{100}.}

\item{line_width}{Numeric. Width of grid lines in the heatmap. Default is \code{1}.}

\item{line_col}{Character. Color of grid lines in the heatmap. Default is \code{"grey80"}.}

\item{debug}{Logical. Whether to display debug messages during function execution. Default is \code{TRUE}.}
}
\value{
A \code{ComplexHeatmap} object representing the heatmap visualization. The heatmap is also saved to a PDF file.
}
\description{
This function generates a heatmap visualization from DefenseFinder results, including annotations
for diversity metrics and customizable aesthetics such as color gradients and barplot styles.
}
\details{
This function processes DefenseFinder results to generate a heatmap visualization. It links GenBank features
from the \code{Genome_summary_df} dataset and annotates rows with genus and species colors. The barplot annotation
shows diversity metrics per sample.

Customization options include:
\itemize{
\item Heatmap cell color gradient (\code{color_palette}).
\item Barplot fill color (\code{bar_color}).
\item Font sizes and line aesthetics (\code{line_width}, \code{line_col}).
}

The function requires \code{ComplexHeatmap}, \code{circlize}, \code{grid}, \code{reshape2}, and \code{tidyverse} packages.
}
\examples{
# Generate a heatmap using default settings:
DefenseFinder_Heatmap()

# Customize the color palette and barplot color:
DefenseFinder_Heatmap(
    color_palette = c("white", "#FF5733"),
    bar_color = "#33A1FF",
    debug = FALSE
)

}
